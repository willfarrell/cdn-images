base:
  image: willfarrell/codeship-base
  cached: true
  encrypted_env_file: env.encrypted
  volumes:
    - ./:/data

node:
  build:
    image: willfarrell/codeship-node
    context: bin/node
    dockerfile: Dockerfile
  cached: true
  encrypted_env_file: env.encrypted
  env_file: .tmp/env
  volumes_from:
    - base

serverless:
  image: willfarrell/codeship-serverless
  cached: true
  encrypted_env_file: env.encrypted
  env_file: .tmp/env
  volumes_from:
    - base
  volumes:
    - .tmp/.aws/:/root/.aws
